# SolaX Energy Toolkit
## Manual Control for SolaX X1-Hybrid G4 via Modbus (Node-RED)

A fully local, Modbus-based manual control toolkit for the SolaX X1-Hybrid G4 inverter.

No cloud.
No API.
No EMS gateway.
Direct register-level control.

---

# ğŸ¯ What This Project Does

This toolkit provides a safe and transparent way to manually control:

- Self Use mode
- Manual mode
- Force Charge
- Force Discharge
- Charge current limit
- Discharge current limit

All communication happens via Modbus TCP using official G4 registers.

---

# âš™ï¸ Supported Inverter

- SolaX X1-Hybrid G4  
(Other G4 models may work but are not tested)

---

# ğŸ§  Control Philosophy

This project intentionally keeps logic simple and explicit.

You execute manual steps in the correct order:

### To Charge
1. Set Manual Mode (Register 31 â†’ 3)
2. Set Charge Current (Register 36)
3. Set Direction (Register 32 â†’ 1)

### To Discharge
1. Set Manual Mode (Register 31 â†’ 3)
2. Set Discharge Current (Register 37)
3. Set Direction (Register 32 â†’ 2)

### To Stop
- Register 32 â†’ 0

### To Return to Self Use
- Register 31 â†’ 0

No automation is hidden.
No background watchdog.
No implicit state machine.

This is intentional.

---

# ğŸ“¦ Installation

## Requirements

- Node-RED
- node-red-dashboard
- node-red-contrib-modbus
- Modbus TCP access to inverter
  (example: Waveshare TCP â†’ RS485 gateway)

## Import Flow

1. Open Node-RED
2. Menu â†’ Import
3. Select:
4. Open the `modbus-flex-write` node
5. Configure your Modbus TCP server
6. Deploy

---

# ğŸ”Œ Example Modbus Configuration

- Host: 10.0.36.75
- Port: 502
- Unit ID: 1
- Command Delay: 200 ms
- Parallel Unit IDs: Disabled

---

# ğŸ“˜ Register Mapping

| Register | Address | Description |
|----------|----------|-------------|
| 31 | 0x001F | 0 = SelfUse, 3 = Manual |
| 32 | 0x0020 | 0 = Stop, 1 = Charge, 2 = Discharge |
| 36 | 0x0024 | Charge current (0.1A units) |
| 37 | 0x0025 | Discharge current (0.1A units) |

Current values use 0.1A resolution.

Example:
- 15A â†’ value 150
- 5A â†’ value 50

No negative values are required for discharge.

---

# ğŸ›¡ Safety Notes

- Inverter may revert to SelfUse if:
  - SOC limits are reached
  - Protection triggers
  - Time schedules override

- Always configure:
  - Minimum SOC
  - Maximum charge/discharge current
  - Grid protection settings

This project does not override internal inverter protections.

Use at your own risk.

---

# ğŸš€ Roadmap

Planned modules:

- Core state module
- MQTT bridge
- Peak shaving controller
- Grid import limiter
- SOC-based automation
- Scheduler module
- HA integration package

Manual control remains the stable base layer.

---

# ğŸ“œ License

MIT License
